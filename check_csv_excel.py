import pandas as pd

# –ü—Ä–æ–≤–µ—Ä—è–µ–º CSV —Ñ–∞–π–ª
print("üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ CSV —Ñ–∞–π–ª–∞ —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π")
print("="*50)

# –ß–∏—Ç–∞–µ–º CSV
df = pd.read_csv('ml_recommendations_demo.csv', encoding='utf-8-sig')

print(f"‚úÖ –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–Ω")
print(f"üìä –†–∞–∑–º–µ—Ä: {df.shape[0]} —Å—Ç—Ä–æ–∫, {df.shape[1]} –∫–æ–ª–æ–Ω–æ–∫")
print(f"üìù –ö–æ–ª–æ–Ω–∫–∏: {list(df.columns)}")

print("\nüéØ –ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö:")
print("-" * 30)

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 3 —Å—Ç—Ä–æ–∫–∏ —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π
for i, row in df.head(3).iterrows():
    print(f"\n{i+1}. {row['name']} - {row['product']}")
    print(f"   –°–æ–æ–±—â–µ–Ω–∏–µ: {row['push_notification'][:100]}...")

print("\nüìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
print(f"   –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤: {df['name'].nunique()}")
print(f"   –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤: {df['product'].nunique()}")
print(f"   –°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {df['confidence'].mean():.1%}")
print(f"   –°—Ä–µ–¥–Ω—è—è –≤—ã–≥–æ–¥–∞: {df['benefit'].mean():,.0f} ‚Ç∏")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π
print("\nüîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏:")
problematic_chars = []
for col in df.columns:
    if df[col].dtype == 'object':  # —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏
        for val in df[col].dropna():
            if isinstance(val, str) and any(ord(c) > 127 for c in val):
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–∏—Ä–∏–ª–ª–∏—Ü–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
                if '' in val or '?' in val:
                    problematic_chars.append(f"{col}: {val[:50]}...")

if problematic_chars:
    print("‚ùå –ù–∞–π–¥–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π:")
    for problem in problematic_chars[:5]:  # –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 5
        print(f"   {problem}")
else:
    print("‚úÖ –ö–æ–¥–∏—Ä–æ–≤–∫–∞ –≤ –ø–æ—Ä—è–¥–∫–µ - –∫–∏—Ä–∏–ª–ª–∏—Ü–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ")

print("\nüíæ –§–∞–π–ª –≥–æ—Ç–æ–≤ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –≤ Excel!")
print("   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥–∏—Ä–æ–≤–∫—É UTF-8")
print("   - –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å: –∑–∞–ø—è—Ç–∞—è")
print("   - –ö–∏—Ä–∏–ª–ª–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ")
